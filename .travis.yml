language: java

jdk:
- oraclejdk8
branches:
  only:
  - dev
deploy:
  provider: heroku
  app:
    develop: tp-2017-2-caesar-backend
  api_key:
    secure: 38935a2f-856e-4412-8883-86aaab035f8a
  on:
      repo: java-park-mail-ru/CaesarTeam-09-2017
      branch: dev
    skip_cleanup: true

services:
  - postgresql
before_script:
  - psql -c "create user caesartest with password 'caesartest';" -U postgres
  - psql -c "alter role caesartest with superuser;" -U postgres
  - psql -c "create database caesartest;" -U postgres
  - psql -c "grant all on database caesartest to caesartest;" -U postgres
install:
  - mvn clean install
